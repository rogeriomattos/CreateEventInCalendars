<!DOCTYPE html>
<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

<style>
  .wapper{
    
  }
  .row{
    margin-bottom: 10px;
  }
</style>

</head>
<body>
  <div class="wapper">
    <div class="row">
        <div>Summary/Title:</div>
        <div><input type="text" id="summary" value="Summary example"/></div>
    </div>
    <div class="row">
        <div>Body:</div>
        <div><input type="text" id="body" value="Body example"/></div>
    </div>
    <div class="row">
        <div>Location:</div>
        <div><input type="text" id="location" value="SÃ£o Paulo"/></div>
    </div>
    <div class="row">
        <div>Start Date Time:</div>
        <div><input type="text" id="start-time" value="12/04/2019 00:00"/></div>
    </div>
    <div class="row">
        <div>End Date Time:</div>
        <div><input type="text" id="end-time" value="12/06/2019 09:00"/></div>
    </div>
    
    <div class="row">
        <div>AllDay (not work in google):</div>
        <div><input type="checkbox" id="allDay" /></div>
    </div>
    
    <div class="row">
      <input type="button" value="Outlook 365" id="outlook365"/>
      <input type="button" value="Google" id="google"/>
    </div>
  </div>
  <script>
    $('#outlook365').click(function(){
      var startDateTime = new Date($('#start-time').val()).toISOString();    
      var endDateTime = new Date($('#end-time').val()).toISOString();
      var location = $('#location').val();
      var summary = $('#summary').val();
      var body = $("#body").val();
      var allDay = $("#allDay").is(':checked');
      
      var query = "https://outlook.office.com/owa//?path=/calendar/action/compose&rru=addevent"+
                  "&startdt="+ startDateTime +
                  "&enddt="+ endDateTime +
                  "&subject="+ summary +
                  "&location="+ location + 
                  "&body="+ body +
                  "&allday="+allDay;

      window.open(query, "_blank");
    });

    $("#google").click(function(){
      var startDateTime = new Date($('#start-time').val()).toISOString().replace(".000","").replace(/[^a-zA-Z0-9]/g, "");    
      var endDateTime = new Date($('#end-time').val()).toISOString().replace(".000","").replace(/[^a-zA-Z0-9]/g, "");
      
      var location = $('#location').val();
      var summary = $('#summary').val();
      var body = $("#body").val();
      var allDay = $("#allDay").is(':checked');
      console.log(allDay);
      if(allDay){
        startDateTime = startDateTime.split("T")[0];
        console.log(startDateTime);
        endDateTime = new Date($('#start-time').val());
        console.log(endDateTime);
        endDateTime.setDate(endDateTime.getDate()+1);
        console.log(endDateTime);
        endDateTime = endDateTime.toISOString().replace(/[^a-zA-Z0-9]/g, "").split("T")[0];
      }
      var query = "http://www.google.com/calendar/event?"+
                  "action=TEMPLATE"+
                  "&text="+summary+
                  "&dates="+startDateTime+"/"+endDateTime+
                  "&details="+body+
                  "&location="+location;
      window.open(query, "_blank");
    });

    $("#fileIcs").click(function(){
      var icsMSG = "BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//Our Company//NONSGML v1.0//EN\nBEGIN:VEVENT\nUID:me@google.com\nDTSTAMP:20120315T170000Z\nATTENDEE;CN=My Self ;RSVP=TRUE:MAILTO:me@gmail.com\nORGANIZER;CN=Me:MAILTO::me@gmail.com\nDTSTART:" + startDateTime +"\nDTEND:" + endDateTime +"\nLOCATION:" + location + "\nSUMMARY:Our Meeting Office\nEND:VEVENT\nEND:VCALENDAR";
    });

  </script>
</body>
</html>